<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>Flask+Vue.js(4)- Vue.js connects with flask APIs | Weird Lab</title><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css"><script src="/js/third-party/jquery.min.js">           </script><script src="/js/third-party/velocity.min.js">           </script><script src="/js/third-party/velocity.ui.min.js">           </script><link rel="icon" href="/img/robomongo.png"><meta name="generator" content="Hexo 4.2.1"></head><body><nav id="nav-bar"><nav class="clear-fix" id="nav-container"><div class="pull-left" id="page-home"><a href="/">Weird Lab</a></div><i class="fa fa-bars pull-right" id="toggle-nav" aria-hidden="true"></i><ul class="pull-right" id="navs"><li><a class="nav" href="/">Home</a></li><li><a class="nav" href="/tags">Tags</a></li><li><a class="nav" href="/categories">Categories</a></li><li><a class="nav" href="/about">About</a></li></ul></nav></nav><header id="header-info"><div id="header-container"><div id="site-info"><div id="terminal-pl"><div id="top-bar"><ul id="control"><li class="btn"></li><li class="btn"></li><li class="btn"></li></ul><div id="file-path"><i class="fa fa-folder folder-ic" aria-hidden="true"></i> weird lab 10 X 10</div></div><div id="code-pl">weird lab:~/blog$
<span class="code-pl-input">source &quot;Flask+Vue.js(4)- Vue.js connects with flask APIs.sh&quot;</span><br><br>weird lab:~/blog$
<span class="code-pl-input">printenv</span><br><span class="code-pl-output">CREATED_DATE = 2020-05-21</span><br><span class="code-pl-output">TAGS =</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/tags/#vue.js"><span class="code-pl-output">vue.js</span></a><span class="code-pl-output"> </span><span class="code-pl-output">:</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/tags/#flask"><span class="code-pl-output">flask</span></a><span class="code-pl-output"> </span><span class="code-pl-output">:</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/tags/#RESTful"><span class="code-pl-output">RESTful</span></a><span class="code-pl-output"> </span><span class="code-pl-output">:</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/tags/#API"><span class="code-pl-output">API</span></a><span class="code-pl-output"> </span><span class="code-pl-output">:</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/tags/#FullStack"><span class="code-pl-output">FullStack</span></a><span class="code-pl-output"> </span><span class="code-pl-output"></span><br><span class="code-pl-output">CATEGORIES =</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/categories/#Vue.js"><span class="code-pl-output">Vue.js</span></a><span class="code-pl-output"> </span><span class="code-pl-output">:</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/categories/#Flask"><span class="code-pl-output">Flask</span></a><span class="code-pl-output"> </span><span class="code-pl-output"></span><br><br>weird lab:~/blog$
<span class="code-pl-input">grep -lr $TAGS post</span><br><span class="code-pl-output">2020-05-01</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/2020/05/01/flask-vue-js-1/" target="_blank"><span class="code-pl-output">Flask+Vue.js(1)- The First Flask RESTful API</span></a><br><span class="code-pl-output">2020-05-01</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/2020/05/01/flask-vue-js-2/" target="_blank"><span class="code-pl-output">Flask+Vue.js(2)- Vue.js Connect With Flask RESTful API By Axios</span></a><br><span class="code-pl-output">2020-05-08</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/2020/05/08/flask-vue-js-3/" target="_blank"><span class="code-pl-output">Flask+Vue.js(3)- Design User Model APIs</span></a><br><span class="code-pl-output">2020-05-21</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/2020/05/21/flask-vue-js-4/" target="_blank"><span class="code-pl-output">Flask+Vue.js(4)- Vue.js connects with flask APIs</span></a><br><span class="code-pl-output">2020-05-21</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/2020/05/21/flask-vue-js-5/" target="_blank"><span class="code-pl-output">Flask+Vue.js(5)- User Homepage and User Avatar</span></a><br><span class="code-pl-output">2020-05-21</span><span class="code-pl-output"> </span><a class="code-pl-output-url" href="/2020/05/21/flask-vue-js-6/" target="_blank"><span class="code-pl-output">Flask+Vue.js(6)- Blog CRUD And Markdown</span></a><br><!--if page.next| > .prev
br
a(href=url_for(page.next.path))
  span.answer= page.next.title
br
br--><!--if page.prev| > .next
br
a(href=url_for(page.prev.path))
  span.answer= page.prev.title--></div></div></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><a class="article-title">Flask+Vue.js(4)- Vue.js connects with flask APIs</a><time class="article-date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-05-21</time><h1 id="1-Vue-Router-navigation"><a href="#1-Vue-Router-navigation" class="headerlink" title="1.Vue-Router navigation"></a>1.Vue-Router navigation</h1><h2 id="1-1-Layout"><a href="#1-1-Layout" class="headerlink" title="1.1 Layout"></a>1.1 Layout</h2><p>The general page layout of the front end is as follows:<br><img src="/2020/05/21/flask-vue-js-4/vue1.jpeg" alt="vue"></p>
<a id="more"></a>
<p>The navigation bar component is shared, introduced in frontend/src/App.vue<br>Create <code>front-end/src/components/Navbar.vue</code>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"navbar navbar-expand-lg navbar-light bg-light"</span> <span class="attr">style</span>=<span class="string">"margin-bottom: 20px;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/"</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"../assets/logo.png"</span> <span class="attr">width</span>=<span class="string">"30"</span> <span class="attr">height</span>=<span class="string">"30"</span> <span class="attr">class</span>=<span class="string">"d-inline-block align-top"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">          MadBlog</span><br><span class="line">      <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"navbar-toggler"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">data-toggle</span>=<span class="string">"collapse"</span> <span class="attr">data-target</span>=<span class="string">"#navbarSupportedContent"</span> <span class="attr">aria-controls</span>=<span class="string">"navbarSupportedContent"</span> <span class="attr">aria-expanded</span>=<span class="string">"false"</span> <span class="attr">aria-label</span>=<span class="string">"Toggle navigation"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"navbar-toggler-icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"collapse navbar-collapse"</span> <span class="attr">id</span>=<span class="string">"navbarSupportedContent"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"navbar-nav mr-auto mt-2 mt-lg-0"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item active"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/"</span> <span class="attr">class</span>=<span class="string">"nav-link"</span>&gt;</span>Home <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>(current)<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"nav-link disabled"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Explore<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-inline navbar-left mr-auto"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control mr-sm-2"</span> <span class="attr">type</span>=<span class="string">"search"</span> <span class="attr">placeholder</span>=<span class="string">"Search"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-outline-success my-2 my-sm-0"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>Search<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav navbar-right"</span>&gt;</span>          </span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"nav-link disabled"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Messages<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/profile"</span> <span class="attr">class</span>=<span class="string">"nav-link"</span>&gt;</span>Profile<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/login"</span> <span class="attr">class</span>=<span class="string">"nav-link"</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  name: <span class="string">'Navbar'</span>  <span class="comment">//this is the name of the component</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Modify <code>front-end/src/App.vue</code>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">navbar</span>&gt;</span><span class="tag">&lt;/<span class="name">navbar</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> Navbar <span class="keyword">from</span> <span class="string">'./components/Navbar'</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  name: <span class="string">'App'</span>,</span></span><br><span class="line">  components: &#123;</span><br><span class="line">    navbar: Navbar</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="1-2-Alert-component"><a href="#1-2-Alert-component" class="headerlink" title="1.2 Alert component"></a>1.2 Alert component</h2><p>Create sub-component <code>front-end/src/components/Alert.vue</code>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert"</span> <span class="attr">role</span>=<span class="string">"alert"</span> <span class="attr">v-bind:class</span>=<span class="string">"'alert-' + variant"</span>&gt;</span></span><br><span class="line">    &#123;&#123; message &#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  props: [<span class="string">'variant'</span>, <span class="string">'message'</span>]</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Create parent component  <code>front-end/src/components/Home.vue</code>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">alert</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">v-for</span>=<span class="string">"(alert, index) in alerts"</span> <span class="attr">:key</span>=<span class="string">"index"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-if</span>=<span class="string">"alert.showAlert"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-bind:variant</span>=<span class="string">"alert.alertVariant"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-bind:message</span>=<span class="string">"alert.alertMessage"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">alert</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>HomePage<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> Alert <span class="keyword">from</span> <span class="string">'./Alert'</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  name: <span class="string">'Home'</span>,  <span class="comment">//this is the name of the component</span></span></span><br><span class="line">  components: &#123;</span><br><span class="line">    alert: Alert</span><br><span class="line">  &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line"><span class="actionscript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      alerts: [</span><br><span class="line">        &#123;</span><br><span class="line"><span class="actionscript">          showAlert: <span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">          alertVariant: <span class="string">'danger'</span>,</span></span><br><span class="line">          alertMessage: 0</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line"><span class="actionscript">          showAlert: <span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">          alertVariant: <span class="string">'info'</span>,</span></span><br><span class="line">          alertMessage: 1</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line"><span class="actionscript">          showAlert: <span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">          alertVariant: <span class="string">'dark'</span>,</span></span><br><span class="line">          alertMessage: 2</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="1-3-Navigation-guard-Before-Each"><a href="#1-3-Navigation-guard-Before-Each" class="headerlink" title="1.3 Navigation guard: Before Each"></a>1.3 Navigation guard: Before Each</h2><p>Only after the user logs in can he access Home, Profile page, etc. You need to use <code>Vue-Router&#39;s router.beforeEach()</code> to determine whether user authentication is required before each route.<br>Modify <code>front-end/src/router/index.js</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">'@/components/Home'</span></span><br><span class="line"><span class="keyword">import</span> Login <span class="keyword">from</span> <span class="string">'@/components/Login'</span></span><br><span class="line"><span class="keyword">import</span> Register <span class="keyword">from</span> <span class="string">'@/components/Register'</span></span><br><span class="line"><span class="keyword">import</span> Profile <span class="keyword">from</span> <span class="string">'@/components/Profile'</span></span><br><span class="line"><span class="keyword">import</span> Ping <span class="keyword">from</span> <span class="string">'@/components/Ping'</span></span><br><span class="line"></span><br><span class="line">Vue.use(Router)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/'</span>,</span><br><span class="line">      name: <span class="string">'Home'</span>,</span><br><span class="line">      component: Home,</span><br><span class="line">      meta: &#123;</span><br><span class="line">        requiresAuth: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/login'</span>,</span><br><span class="line">      name: <span class="string">'Login'</span>,</span><br><span class="line">      component: Login</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/register'</span>,</span><br><span class="line">      name: <span class="string">'Register'</span>,</span><br><span class="line">      component: Register</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/profile'</span>,</span><br><span class="line">      name: <span class="string">'Profile'</span>,</span><br><span class="line">      component: Profile,</span><br><span class="line">      meta: &#123;</span><br><span class="line">        requiresAuth: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/ping'</span>,</span><br><span class="line">      name: <span class="string">'Ping'</span>,</span><br><span class="line">      component: Ping</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> token = <span class="built_in">window</span>.localStorage.getItem(<span class="string">'token'</span>)</span><br><span class="line">  <span class="keyword">if</span> (to.matched.some(<span class="function"><span class="params">record</span> =&gt;</span> record.meta.requiresAuth) &amp;&amp; (!token || token === <span class="literal">null</span>)) &#123;</span><br><span class="line">    next(&#123;</span><br><span class="line">      path: <span class="string">'/login'</span>,</span><br><span class="line">      query: &#123; <span class="attr">redirect</span>: to.fullPath &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (token &amp;&amp; to.name == <span class="string">'Login'</span>) &#123;</span><br><span class="line">    next(&#123;</span><br><span class="line">      path: <span class="keyword">from</span>.fullPath</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    next()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>
<p>Now if the client wants to access <code>http://localhost:8080/#/</code>, it will be redirected to <code>http://localhost:8080/#/login?redirect=%2F</code>, it needs to log in and verify first</p>
<h1 id="2-User-registration"><a href="#2-User-registration" class="headerlink" title="2. User registration"></a>2. User registration</h1><p>The <code>Register.vue</code> component’s code is as follows</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Register<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> @<span class="attr">submit.prevent</span>=<span class="string">"onSubmit"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"username"</span>&gt;</span>Username<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"registerForm.username"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">v-bind:class</span>=<span class="string">"&#123;'is-invalid': registerForm.usernameError&#125;"</span> <span class="attr">id</span>=<span class="string">"username"</span> <span class="attr">placeholder</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-show</span>=<span class="string">"registerForm.usernameError"</span> <span class="attr">class</span>=<span class="string">"invalid-feedback"</span>&gt;</span>&#123;&#123; registerForm.usernameError &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"email"</span>&gt;</span>Email address<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">v-model</span>=<span class="string">"registerForm.email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">v-bind:class</span>=<span class="string">"&#123;'is-invalid': registerForm.emailError&#125;"</span> <span class="attr">id</span>=<span class="string">"email"</span> <span class="attr">aria-describedby</span>=<span class="string">"emailHelp"</span> <span class="attr">placeholder</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">small</span> <span class="attr">v-if</span>=<span class="string">"!registerForm.emailError"</span> <span class="attr">id</span>=<span class="string">"emailHelp"</span> <span class="attr">class</span>=<span class="string">"form-text text-muted"</span>&gt;</span>We'll never share your email with anyone else.<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-show</span>=<span class="string">"registerForm.emailError"</span> <span class="attr">class</span>=<span class="string">"invalid-feedback"</span>&gt;</span>&#123;&#123; registerForm.emailError &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"password"</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">v-model</span>=<span class="string">"registerForm.password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">v-bind:class</span>=<span class="string">"&#123;'is-invalid': registerForm.passwordError&#125;"</span> <span class="attr">id</span>=<span class="string">"password"</span> <span class="attr">placeholder</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-show</span>=<span class="string">"registerForm.passwordError"</span> <span class="attr">class</span>=<span class="string">"invalid-feedback"</span>&gt;</span>&#123;&#123; registerForm.passwordError &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>Register<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  name: <span class="string">'Register'</span>, <span class="comment">//this is the name of the component</span></span></span><br><span class="line">  data () &#123;</span><br><span class="line"><span class="actionscript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      registerForm: &#123;</span><br><span class="line"><span class="actionscript">        username: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        email: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        password: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        submitted: <span class="literal">false</span>,  <span class="comment">// if click the button submit</span></span></span><br><span class="line"><span class="actionscript">        errors: <span class="number">0</span>,  <span class="comment">//  if the form valide at front-end, 0 shows no errors</span></span></span><br><span class="line"><span class="actionscript">        usernameError: <span class="literal">null</span>,</span></span><br><span class="line"><span class="actionscript">        emailError: <span class="literal">null</span>,</span></span><br><span class="line"><span class="actionscript">        passwordError: <span class="literal">null</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onSubmit (e) &#123;</span><br><span class="line"><span class="actionscript">      <span class="keyword">this</span>.registerForm.submitted = <span class="literal">true</span>  </span></span><br><span class="line"><span class="actionscript">      <span class="keyword">this</span>.registerForm.errors = <span class="number">0</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">if</span> (!<span class="keyword">this</span>.registerForm.username) &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.registerForm.errors++</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.registerForm.usernameError = <span class="string">'Username required.'</span></span></span><br><span class="line"><span class="actionscript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.registerForm.usernameError = <span class="literal">null</span></span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">if</span> (!<span class="keyword">this</span>.registerForm.email) &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.registerForm.errors++</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.registerForm.emailError = <span class="string">'Email required.'</span></span></span><br><span class="line"><span class="actionscript">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">this</span>.validEmail(<span class="keyword">this</span>.registerForm.email)) &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.registerForm.errors++</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.registerForm.emailError = <span class="string">'Valid email required.'</span></span></span><br><span class="line"><span class="actionscript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.registerForm.emailError = <span class="literal">null</span></span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">if</span> (!<span class="keyword">this</span>.registerForm.password) &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.registerForm.errors++</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.registerForm.passwordError = <span class="string">'Password required.'</span></span></span><br><span class="line"><span class="actionscript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.registerForm.passwordError = <span class="literal">null</span></span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">if</span> (<span class="keyword">this</span>.registerForm.errors &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> <span class="literal">false</span></span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">const</span> path = <span class="string">'http://localhost:5000/api/users'</span></span></span><br><span class="line"><span class="actionscript">      <span class="keyword">const</span> payload = &#123;</span></span><br><span class="line"><span class="actionscript">        username: <span class="keyword">this</span>.registerForm.username,</span></span><br><span class="line"><span class="actionscript">        email: <span class="keyword">this</span>.registerForm.email,</span></span><br><span class="line"><span class="actionscript">        password: <span class="keyword">this</span>.registerForm.password</span></span><br><span class="line">      &#125;</span><br><span class="line">      axios.post(path, payload)</span><br><span class="line"><span class="javascript">        .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">          <span class="comment">// handle success</span></span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.$router.push(<span class="string">'/login'</span>)</span></span><br><span class="line">        &#125;)</span><br><span class="line"><span class="javascript">        .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">          <span class="comment">// handle error</span></span></span><br><span class="line"><span class="actionscript">          <span class="keyword">for</span> (<span class="keyword">var</span> field <span class="keyword">in</span> error.response.data.message) &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">if</span> (field == <span class="string">'username'</span>) &#123;</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">this</span>.registerForm.usernameError = error.response.data.message.username</span></span><br><span class="line"><span class="actionscript">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (field == <span class="string">'email'</span>) &#123;</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">this</span>.registerForm.emailError = error.response.data.message.email</span></span><br><span class="line"><span class="actionscript">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (field == <span class="string">'password'</span>) &#123;</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">this</span>.registerForm.passwordError = error.response.data.message.password</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line"><span class="actionscript">    validEmail: <span class="function"><span class="keyword">function</span> <span class="params">(email)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> re = /^(([^&lt;&gt;()\[\]\\.,;:\s@<span class="string">"]+(\.[^&lt;&gt;()\[\]\\.,;:\s@"</span>]+)*)|(<span class="string">".+"</span>))@((\[[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">1</span>,<span class="number">3</span>&#125;\.[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">1</span>,<span class="number">3</span>&#125;\.[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">1</span>,<span class="number">3</span>&#125;\.[<span class="number">0</span><span class="number">-9</span>]&#123;<span class="number">1</span>,<span class="number">3</span>&#125;\])|(([a-zA-Z\<span class="number">-0</span><span class="number">-9</span>]+\.)+[a-zA-Z]&#123;<span class="number">2</span>,&#125;))$/;</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">return</span> re.test(email);</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/21/flask-vue-js-4/vue2.jpeg" alt="vue2"></p>
<h1 id="3-State-Management"><a href="#3-State-Management" class="headerlink" title="3. State Management"></a>3. State Management</h1><p>If the registration is successful, it will jump to the login page. At this time, it is expected that there will be an Alert message “Congratulations, you are now a registered user !” to remind you that the registration is successful, so if needs two components of before and after maintain a same state <code>is_new</code> together. Because this project is very simple, we did not use vuex, we use store for state management.<br><img src="/2020/05/21/flask-vue-js-4/vue3.jpeg" alt="vue3"><br>Create <code>ront-end/src/store.js</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  debug: <span class="literal">true</span>,</span><br><span class="line">  state: &#123;</span><br><span class="line">    is_new: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">  setNewAction () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.debug) &#123; <span class="built_in">console</span>.log(<span class="string">'setNewAction triggered'</span>) &#125;</span><br><span class="line">    <span class="keyword">this</span>.state.is_new = <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  resetNotNewAction () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.debug) &#123; <span class="built_in">console</span>.log(<span class="string">'resetNotNewAction triggered'</span>) &#125;</span><br><span class="line">    <span class="keyword">this</span>.state.is_new = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In the component <code>Register.vue</code> indeet to import <code>store</code>, when the user registration is successful, the program calls <code>setNewAction</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'../store.js'</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">axios.post(path, payload)</span><br><span class="line">        .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// handle success</span></span><br><span class="line">          store.setNewAction()</span><br><span class="line">          <span class="keyword">this</span>.$router.push(<span class="string">'/login'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>In the component <code>Login.vue</code> need to import <code>Alert.vue</code> and  <code>store</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">    &lt;alert </span><br><span class="line">      v-<span class="keyword">if</span>=<span class="string">"sharedState.is_new"</span></span><br><span class="line">      v-bind:variant=<span class="string">"alertVariant"</span></span><br><span class="line">      v-bind:message=<span class="string">"alertMessage"</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/alert&gt;</span></span><br><span class="line"><span class="regexp">    ...</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> Alert <span class="keyword">from</span> <span class="string">'./Alert'</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'../store.js'</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">'Login'</span>,  <span class="comment">//this is the name of the component</span></span><br><span class="line">  components: &#123;</span><br><span class="line">    alert: Alert</span><br><span class="line">  &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      sharedState: store.state,</span><br><span class="line">      alertVariant: <span class="string">'info'</span>,</span><br><span class="line">      alertMessage: <span class="string">'Congratulations, you are now a registered user !'</span>,</span><br><span class="line">      ...</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onSubmit (e) &#123;</span><br><span class="line">      ...</span><br><span class="line">      axios.post(path, &#123;&#125;, &#123;</span><br><span class="line">        auth: &#123;</span><br><span class="line">          <span class="string">'username'</span>: <span class="keyword">this</span>.loginForm.username,</span><br><span class="line">          <span class="string">'password'</span>: <span class="keyword">this</span>.loginForm.password</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// handle success</span></span><br><span class="line">          <span class="built_in">window</span>.localStorage.setItem(<span class="string">'madblog-token'</span>, response.data.token)</span><br><span class="line">          store.resetNotNewAction()</span><br><span class="line">          <span class="keyword">this</span>.$router.push(<span class="string">'/'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>Similarly, when the user logs in before the navigation bar displays Login, after the user logs in, it displays Logout, and a common status <code>is_authenticated</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">  debug: <span class="literal">true</span>,</span><br><span class="line">  state: &#123;</span><br><span class="line">    is_new: <span class="literal">false</span>,</span><br><span class="line">    is_authenticated: <span class="built_in">window</span>.localStorage.getItem(<span class="string">'madblog-token'</span>) ? <span class="literal">true</span> : <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">  setNewAction () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.debug) &#123; <span class="built_in">console</span>.log(<span class="string">'setNewAction triggered'</span>) &#125;</span><br><span class="line">    <span class="keyword">this</span>.state.is_new = <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  resetNotNewAction () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.debug) &#123; <span class="built_in">console</span>.log(<span class="string">'resetNotNewAction triggered'</span>) &#125;</span><br><span class="line">    <span class="keyword">this</span>.state.is_new = <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">  loginAction () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.debug) &#123; <span class="built_in">console</span>.log(<span class="string">'loginAction triggered'</span>) &#125;</span><br><span class="line">    <span class="keyword">this</span>.state.is_authenticated = <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  logoutAction () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.debug) <span class="built_in">console</span>.log(<span class="string">'logoutAction triggered'</span>)</span><br><span class="line">    <span class="built_in">window</span>.localStorage.removeItem(<span class="string">'madblog-token'</span>)</span><br><span class="line">    <span class="keyword">this</span>.state.is_authenticated = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>When login sucessfully, call <code>store.loginAction()</code> and set state is true, modify navigation component:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"navbar navbar-expand-lg navbar-light bg-light"</span> <span class="attr">style</span>=<span class="string">"margin-bottom: 20px;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/"</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://getbootstrap.com/docs/4.1/assets/brand/bootstrap-solid.svg"</span> <span class="attr">width</span>=<span class="string">"30"</span> <span class="attr">height</span>=<span class="string">"30"</span> <span class="attr">class</span>=<span class="string">"d-inline-block align-top"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">          MadBlog</span><br><span class="line">      <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"navbar-toggler"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">data-toggle</span>=<span class="string">"collapse"</span> <span class="attr">data-target</span>=<span class="string">"#navbarSupportedContent"</span> <span class="attr">aria-controls</span>=<span class="string">"navbarSupportedContent"</span> <span class="attr">aria-expanded</span>=<span class="string">"false"</span> <span class="attr">aria-label</span>=<span class="string">"Toggle navigation"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"navbar-toggler-icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"collapse navbar-collapse"</span> <span class="attr">id</span>=<span class="string">"navbarSupportedContent"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"navbar-nav mr-auto mt-2 mt-lg-0"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item active"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/"</span> <span class="attr">class</span>=<span class="string">"nav-link"</span>&gt;</span>Home <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>(current)<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"nav-link disabled"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Explore<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">v-if</span>=<span class="string">"sharedState.is_authenticated"</span> <span class="attr">class</span>=<span class="string">"form-inline navbar-left mr-auto"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control mr-sm-2"</span> <span class="attr">type</span>=<span class="string">"search"</span> <span class="attr">placeholder</span>=<span class="string">"Search"</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 暂时先禁止提交，后续实现搜索再改回 type="submit" --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-outline-success my-2 my-sm-0"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>Search<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">v-if</span>=<span class="string">"sharedState.is_authenticated"</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav navbar-right"</span>&gt;</span>          </span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"nav-link disabled"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Messages<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/profile"</span> <span class="attr">class</span>=<span class="string">"nav-link"</span>&gt;</span>Profile<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click</span>=<span class="string">"handlerLogout"</span> <span class="attr">class</span>=<span class="string">"nav-link"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Logout<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav navbar-right"</span>&gt;</span>          </span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/login"</span> <span class="attr">class</span>=<span class="string">"nav-link"</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'../store.js'</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  name: <span class="string">'Navbar'</span>,  <span class="comment">//this is the name of the component</span></span></span><br><span class="line">  data () &#123;</span><br><span class="line"><span class="actionscript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      sharedState: store.state</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handlerLogout (e) &#123;</span><br><span class="line">      store.logoutAction()</span><br><span class="line"><span class="actionscript">      <span class="keyword">this</span>.$router.push(<span class="string">'/login'</span>)</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="4-User-Login"><a href="#4-User-Login" class="headerlink" title="4. User Login"></a>4. User Login</h1><figure class="highlight plain"><figcaption><span>component:</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">&#96;&#96;&#96;html</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">    &lt;alert </span><br><span class="line">      v-if&#x3D;&quot;sharedState.is_new&quot;</span><br><span class="line">      v-bind:variant&#x3D;&quot;alertVariant&quot;</span><br><span class="line">      v-bind:message&#x3D;&quot;alertMessage&quot;&gt;</span><br><span class="line">    &lt;&#x2F;alert&gt;</span><br><span class="line">    &lt;h1&gt;Sign In&lt;&#x2F;h1&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;row&quot;&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;col-md-4&quot;&gt;</span><br><span class="line">        &lt;form @submit.prevent&#x3D;&quot;onSubmit&quot;&gt;</span><br><span class="line">          &lt;div class&#x3D;&quot;form-group&quot;&gt;</span><br><span class="line">            &lt;label for&#x3D;&quot;username&quot;&gt;Username&lt;&#x2F;label&gt;</span><br><span class="line">            &lt;input type&#x3D;&quot;text&quot; v-model&#x3D;&quot;loginForm.username&quot; class&#x3D;&quot;form-control&quot; v-bind:class&#x3D;&quot;&#123;&#39;is-invalid&#39;: loginForm.usernameError&#125;&quot; id&#x3D;&quot;username&quot; placeholder&#x3D;&quot;&quot;&gt;</span><br><span class="line">            &lt;div v-show&#x3D;&quot;loginForm.usernameError&quot; class&#x3D;&quot;invalid-feedback&quot;&gt;&#123;&#123; loginForm.usernameError &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">          &lt;&#x2F;div&gt;</span><br><span class="line">          &lt;div class&#x3D;&quot;form-group&quot;&gt;</span><br><span class="line">            &lt;label for&#x3D;&quot;password&quot;&gt;Password&lt;&#x2F;label&gt;</span><br><span class="line">            &lt;input type&#x3D;&quot;password&quot; v-model&#x3D;&quot;loginForm.password&quot; class&#x3D;&quot;form-control&quot; v-bind:class&#x3D;&quot;&#123;&#39;is-invalid&#39;: loginForm.passwordError&#125;&quot; id&#x3D;&quot;password&quot; placeholder&#x3D;&quot;&quot;&gt;</span><br><span class="line">            &lt;div v-show&#x3D;&quot;loginForm.passwordError&quot; class&#x3D;&quot;invalid-feedback&quot;&gt;&#123;&#123; loginForm.passwordError &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">          &lt;&#x2F;div&gt;</span><br><span class="line">          &lt;button type&#x3D;&quot;submit&quot; class&#x3D;&quot;btn btn-primary&quot;&gt;Sign In&lt;&#x2F;button&gt;</span><br><span class="line">        &lt;&#x2F;form&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;p&gt;New User? &lt;router-link to&#x3D;&quot;&#x2F;register&quot;&gt;Click to Register!&lt;&#x2F;router-link&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">        Forgot Your Password?</span><br><span class="line">        &lt;a href&#x3D;&quot;#&quot;&gt;Click to Reset It&lt;&#x2F;a&gt;</span><br><span class="line">    &lt;&#x2F;p&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import axios from &#39;axios&#39;</span><br><span class="line">import Alert from &#39;.&#x2F;Alert&#39;</span><br><span class="line">import store from &#39;..&#x2F;store.js&#39;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;Login&#39;,  &#x2F;&#x2F;this is the name of the component</span><br><span class="line">  components: &#123;</span><br><span class="line">    alert: Alert</span><br><span class="line">  &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      sharedState: store.state,</span><br><span class="line">      alertVariant: &#39;info&#39;,</span><br><span class="line">      alertMessage: &#39;Congratulations, you are now a registered user !&#39;,</span><br><span class="line">      loginForm: &#123;</span><br><span class="line">        username: &#39;&#39;,</span><br><span class="line">        password: &#39;&#39;,</span><br><span class="line">        submitted: false,  &#x2F;&#x2F; if click the button submit</span><br><span class="line">        errors: 0,  </span><br><span class="line">        usernameError: null,</span><br><span class="line">        passwordError: null</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onSubmit (e) &#123;</span><br><span class="line">      this.loginForm.submitted &#x3D; true  </span><br><span class="line">      this.loginForm.errors &#x3D; 0</span><br><span class="line"></span><br><span class="line">      if (!this.loginForm.username) &#123;</span><br><span class="line">        this.loginForm.errors++</span><br><span class="line">        this.loginForm.usernameError &#x3D; &#39;Username required.&#39;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.loginForm.usernameError &#x3D; null</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (!this.loginForm.password) &#123;</span><br><span class="line">        this.loginForm.errors++</span><br><span class="line">        this.loginForm.passwordError &#x3D; &#39;Password required.&#39;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.loginForm.passwordError &#x3D; null</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (this.loginForm.errors &gt; 0) &#123;</span><br><span class="line">        return false</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      const path &#x3D; &#39;http:&#x2F;&#x2F;localhost:5000&#x2F;api&#x2F;tokens&#39;</span><br><span class="line">      axios.post(path, &#123;&#125;, &#123;</span><br><span class="line">        auth: &#123;</span><br><span class="line">          &#39;username&#39;: this.loginForm.username,</span><br><span class="line">          &#39;password&#39;: this.loginForm.password</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;).then((response) &#x3D;&gt; &#123;</span><br><span class="line">          &#x2F;&#x2F; handle success</span><br><span class="line">          window.localStorage.setItem(&#39;madblog-token&#39;, response.data.token)</span><br><span class="line">          store.resetNotNewAction()</span><br><span class="line">          store.loginAction()</span><br><span class="line"></span><br><span class="line">          if (typeof this.$route.query.redirect &#x3D;&#x3D; &#39;undefined&#39;) &#123;</span><br><span class="line">            this.$router.push(&#39;&#x2F;&#39;)</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            this.$router.push(this.$route.query.redirect)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((error) &#x3D;&gt; &#123;</span><br><span class="line">          &#x2F;&#x2F; handle error</span><br><span class="line">          if (error.response.status &#x3D;&#x3D; 401) &#123;</span><br><span class="line">            this.loginForm.usernameError &#x3D; &#39;Invalid username or password.&#39;</span><br><span class="line">            this.loginForm.passwordError &#x3D; &#39;Invalid username or password.&#39;</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            console.log(error.response)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<h1 id="5-User-Logout"><a href="#5-User-Logout" class="headerlink" title="5.User Logout"></a>5.User Logout</h1><p>Display the Logout button in the navigation bar and bind the click event:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"nav-item"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click</span>=<span class="string">"handlerLogout"</span> <span class="attr">class</span>=<span class="string">"nav-link"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Logout<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'../store.js'</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  name: <span class="string">'Navbar'</span>,  <span class="comment">//this is the name of the component</span></span></span><br><span class="line">  data () &#123;</span><br><span class="line"><span class="actionscript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      sharedState: store.state</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handlerLogout (e) &#123;</span><br><span class="line">      store.logoutAction()</span><br><span class="line"><span class="actionscript">      <span class="keyword">this</span>.$router.push(<span class="string">'/login'</span>)</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="6-Commit-Code"><a href="#6-Commit-Code" class="headerlink" title="6. Commit Code"></a>6. Commit Code</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git add .</span><br><span class="line">$ git commit -m <span class="string">"4. Vue.js calls API to realize user registration/login/out"</span></span><br><span class="line">$ git checkout master</span><br><span class="line">$ git merge dev</span><br><span class="line">$ git branch -d dev</span><br></pre></td></tr></table></figure>
<p>Push the local <code>master</code> branch to the <code>master</code> branch in Github repository:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git push -u origin master</span><br></pre></td></tr></table></figure>
<p>Make a <code>tag</code> then upload:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git tag v0.4</span><br><span class="line">$ git push origin v0.4</span><br></pre></td></tr></table></figure>
<p>The code has been uploaded to <a href="https://github.com/guguji123/blog/releases/tag/v0.4" target="_blank" rel="noopener">https://github.com/guguji123/blog/releases/tag/v0.4</a></p>
</article><article id="post"><script type="text/javascript" src="https://utteranc.es/client.js" repo="guguji123/blog_comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></article><nav id="pagination"><div class="pagination clear-fix"><div class="page-prev pull-left"><a href="/2020/05/21/flask-vue-js-5/"><i class="fa fa-chevron-left"> </i><span>Flask+Vue.js(5)- User Homepage and User Avatar</span></a></div><div class="page-next pull-right"><a href="/2020/05/08/flask-vue-js-3/"><span>Flask+Vue.js(3)- Design User Model APIs</span><i class="fa fa-chevron-right"></i></a></div></div></nav></div></div><footer><div id="footer-inner"><div class="social-icons"></div><p class="design-info">Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme <a href="https://github.com/lazysheep666/terminal_theme" target="_blank">Teminal</a> (<a href="https://github.com/Tonny-Gu/terminal_theme" target="_blank">NekoDaemon Remix</a>)</p><p class="design-info"> 
 Copyright © 2020 weird lab</p></div></footer><script src="/js/nav.js"></script><script src="/js/scroll.js"></script><script src="/js/index.js"></script></body></html>